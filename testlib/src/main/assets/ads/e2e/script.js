!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).InteractionRewardingAds=t()}(function(){return function i(s,o,r){function a(e,t){if(!o[e]){if(!s[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(l)return l(e,!0);throw(n=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",n}n=o[e]={exports:{}},s[e][0].call(n.exports,function(t){return a(s[e][1][t]||t)},n,n.exports,i,s,o,r)}return o[e].exports}for(var l="function"==typeof require&&require,t=0;t<r.length;t++)a(r[t]);return a}({1:[function(t,e,n){const i=t("./timer/Timer"),s=t("./stats/StatsManager"),o=t("./interaction/InteractionRecorder"),r=t("./ui/InteractionRecorderOverlay"),a=t("./ui/CloseWarningModal"),l=t("./ui/CountdownContainer");t=class{constructor(){this.timer=new i,this.stats=new s(this),this.recorder=new o(this.timer),this.ui={clickOverlay:new r(this.recorder),countdownContainer:new l(this),modal:new a(this)},this.api=null}init({desiredDurationMillis:t,desiredInteractionCount:e,autoStart:n=!0}={}){this.stats.initStatsObj({desiredDuration:t,desiredInteractionCount:e}),this.getAndroidApi(),!1!==n&&this.start()}start(){var t=Math.round(this.stats.stats.desiredDuration/1e3);this.timer.start(t),this.ui.clickOverlay.inject(),this.ui.countdownContainer.inject(),this.ui.modal.inject(),this.api.onStart()}getAndroidApi(){try{this.api=AndroidIRA}catch(t){console.error("android api not available")}}close(){this.api.onClose(this.stats.getStats())}closeOnError(t){this.api.onCloseOnError(t.message,this.stats.getStats())}isValidEvent(t){t.isValid=!0}};e.exports=t},{"./interaction/InteractionRecorder":3,"./stats/StatsManager":4,"./timer/Timer":5,"./ui/CloseWarningModal":7,"./ui/CountdownContainer":9,"./ui/InteractionRecorderOverlay":10}],2:[function(t,e,n){const i=t("./InteractionRewardingAds");e.exports=new i},{"./InteractionRewardingAds":1}],3:[function(t,e,n){e.exports=class{constructor(t){this.timer=t,this.interactions=[]}recordInteraction({posX:t,posY:e,target:n,isValid:i=!1}){var s=this.timer.getPassedTime();this.interactions.push({timestamp:s,posX:t,posY:e,target:n,isValid:i})}getAllInteractions(){return Object.assign([],this.interactions)}getValidInteractions(){return Object.assign([],this.interactions.filter(t=>t&&t.isValid))}}},{}],4:[function(t,e,n){e.exports=class{constructor(t){this.manager=t}initStatsObj({desiredDuration:t=0,desiredInteractionCount:e=0}){if("number"!=typeof e)throw new Error("desiredInteractionCount is not a number");if("number"!=typeof t)throw new Error("desiredDuration is not a number");if(e<0)throw new Error("desiredInteractionCount cannot be below zero");if(t<0)throw new Error("desiredDuration cannot be below zero");this.stats={hasEarnedReward:!1,duration:0,desiredDuration:Math.round(t),interactionCount:0,desiredInteractionCount:Math.round(e),allInteractions:[],validInteractions:[],rewardPercentage:0}}buildStats(){null==this.stats&&this.initStatsObj({}),this.stats.duration=this.manager.timer.getPassedTime(),this.stats.hasEarnedReward=this.stats.duration>=this.stats.desiredDuration,this.stats.allInteractions=this.manager.recorder.getAllInteractions(),this.stats.validInteractions=this.manager.recorder.getValidInteractions(),this.stats.interactionCount=this.stats.validInteractions.length,this.stats.rewardPercentage=this.getRewardPercentage()}getRewardPercentage(){return this.stats.desiredInteractionCount<=0?0:this.stats.interactionCount>=this.stats.desiredInteractionCount?100:Math.round(this.stats.interactionCount/this.stats.desiredInteractionCount*100)}getStats(){return this.buildStats(),this.stats}}},{}],5:[function(t,e,n){e.exports=class{event={onCountdownIsZero:"onCountdownIsZero",onOneSecondPassed:"onOneSecondPassed"};constructor(t=30){this.startedAtMillis=this.getCurrentMillis(),this.onOneSecondHandler=null,this.cb={},this.countdown=t}on(t,e){if(null==t||"string"!=typeof t)throw new Error("invalid eventKey: "+t);if(null==e)throw new Error("cb cannot be null");if("function"!=typeof e)throw new Error("cb is not a function");null==this.cb[t]&&(this.cb[t]=[]),this.cb[t].push(e)}off(t){this.cb[t]=null}emit(t,e){if(this.cb[t])try{this.cb[t].forEach(t=>t(e))}catch(t){console.error(t)}}start(t=null){!t&&0!==t||(this.countdown=t),this.startedAtMillis=this.getCurrentMillis();const e=this;this.onOneSecondHandler=setInterval(function(){e.onOneSecond()},1e3)}getPassedTime(){return this.getCurrentMillis()-this.startedAtMillis}getCountdownTime(){return this.countdown}getCurrentMillis(){return(new Date).getTime()}onOneSecond(){this.countdown--,this.emit(this.event.onOneSecondPassed,this.countdown),this.countdown<=0&&(this.emit(this.event.onCountdownIsZero,this.countdown),clearTimeout(this.onOneSecondHandler),this.onOneSecondHandler=null)}}},{}],6:[function(t,e,n){e.exports=class{constructor(t){this.manager=t,this.timer=t.timer,this.onClickFunc=this.onClickFunc.bind(this)}inject(t){try{this.elem=document.createElement("div"),this.elem.id="ira-btn-close",this.elem.innerHTML="X",this.elem.onclick=this.onClickFunc,this.applyStyle(this.elem),t.appendChild(this.elem)}catch(t){console.error(t)}}onClickFunc(){this.timer.getCountdownTime()<=0?this.manager.close():this.manager.ui.modal.toggle()}applyStyle(t){t.style.backgroundColor="#fff",t.style.display="block",t.style.borderRadius="50%",t.style.width="clamp(30px, 2vw, 40px)",t.style.textAlign="center",t.style.fontWeight="600",t.style.textDecoration="none",t.style.fontSize="18px"}}},{}],7:[function(t,e,n){e.exports=class{constructor(t){this.manager=t,this.timer=t.timer,this.onContinue=this.onContinue.bind(this),this.onClose=this.onClose.bind(this),this.hideModal=this.hideModal.bind(this),this.backdrop=null,this.modal=null}hideModal(t){t&&t.target&&t.target.id===this.backdrop.id&&(this.backdrop.style.display="none")}toggle(){"none"!==this.backdrop.style.display?this.backdrop.style.display="none":this.backdrop.style.display="block"}onClose(){this.manager.close()}onContinue(){this.toggle()}inject(){try{this.backdrop=this.createBackdrop(),this.modal=this.createModal(),this.addModalContent(this.modal),this.addModalFooter(this.modal),document.body.appendChild(this.backdrop),this.backdrop.appendChild(this.modal)}catch(t){console.error(t)}}addModalContent(t){const e=document.createElement("div");e.style.display="inline-block",e.style.padding="2vw 2vw 2vw 2vw",e.style.width="auto",e.style.margin="0",e.style.maxHeight="40vh",e.innerHTML="<h1 style='color: cadetblue; margin-top: 5px;'>Warning</h1><p style='font-weight: bold'>Closing this ad will cause you to lose your reward</p>",t.appendChild(e)}addModalFooter(t){const e=this.createFooter(),n=document.createElement("p");n.id="ira-footer-close",n.innerHTML="Close",n.onclick=this.onClose;const i=document.createElement("p");i.id="ira-footer-continue",i.innerHTML="Continue",i.onclick=this.onContinue,this.styleFooterOption(i),this.styleFooterOption(n),t.appendChild(e),e.appendChild(i),e.appendChild(n)}styleFooterOption(t){t.style.display="inline",t.style.fontWeight="bold",t.style.textTransform="uppercase",t.style.textDecoration="none",t.style.padding="0 1.5em",t.style.lineHeight="40px",t.style.margin="0",t.style.color="white"}styleModal(t){t.style.display="flex",t.style.flexDirection="column",t.style.margin="50% auto",t.style.backgroundColor="white",t.style.width="80%",t.style.maxWidth="600px",t.style.minWidth="200px",t.style.boxShadow="0 -8px 40px rgba(0,0,0,.20)",t.style.border="border: 1px solid #eee",t.style.borderRadius="10px 10px"}styleBackdrop(t){t.style.display="none",t.style.position="absolute",t.style.top="0",t.style.right="0",t.style.left="0",t.style.bottom="0",t.style.top="0",t.style.overflow="hidden",t.style.zIndex="99995",t.style.fontFamily="'Open Sans',Arial,sans-serif",t.style.background="rgb(255,255,255,0.85)"}createBackdrop(){const t=document.createElement("div");return t.id="ira-modal-backdrop",t.onclick=this.hideModal,this.styleBackdrop(t),t}createModal(){const t=document.createElement("div");return t.id="ira-modal-content",this.styleModal(t),t}createFooter(){const t=document.createElement("div");return t.style.width="100%",t.style.margin="0",t.style.maxHeight="40px",t.style.background="cadetblue",t.style.textDecoration="none",t.style.textAlign="right",t.style.borderRadius="0 0 10px 10px",t}}},{}],8:[function(t,e,n){e.exports=class{constructor(t){this.timer=t,this.countdownText="Remaining time: {{timeLeft}}",this.readyText="Close",this.elem=null}setCountdownText(t){this.countdownText=t}setReadyText(t){this.readyText=t}inject(t){try{this.elem=document.createElement("div"),this.elem.id="ira-txt-countdown",this.applyStyle(this.elem),this.subscribeToTimerEvents(this.elem),t.appendChild(this.elem)}catch(t){console.error(t)}}processTemplate(t,n){return t.replace(/{{\s?([^{}\s]*)\s?}}/g,(t,e)=>e=n[e])}subscribeToTimerEvents(e){this.timer.on(this.timer.event.onOneSecondPassed,t=>{e.innerHTML=0<t?this.processTemplate(this.countdownText,{timeLeft:t}):this.readyText}),this.timer.on(this.timer.event.onCountdownIsZero,t=>{e.innerHTML=0<t?this.processTemplate(this.countdownText,{timeLeft:t}):this.readyText})}applyStyle(t){t.style.fontFamily="'Open Sans',Arial,sans-serif",t.style.marginRight="clamp(3px, 2vw, 20px)",t.style.display="table-cell",t.style.verticalAlign="middle"}}},{}],9:[function(t,e,n){const i=t("./Countdown"),s=t("./CloseButton");t=class{constructor(t){this.manager=t,this.countdown=new i(t.timer),this.closeButton=new s(t),this.elem=null}inject(t){try{this.elem=document.createElement("div"),this.elem.id="ira-container-countdown",this.applyStyle(this.elem),document.body.appendChild(this.elem),this.countdown.inject(this.elem),this.closeButton.inject(this.elem)}catch(t){console.error(t)}}applyStyle(t){t.style.display="flex",t.style.flexDirection="row",t.style.alignItems="center",t.style.justifyContent="center",t.style.position="absolute",t.style.top="2vh",t.style.right="2vw",t.style.fontFamily="'Open Sans',Arial,sans-serif",t.style.backgroundColor="rgba(25, 25, 25, 0.05)",t.style.padding="5px",t.style.borderRadius="10px",t.style.lineHeight="30px"}};e.exports=t},{"./CloseButton":6,"./Countdown":8}],10:[function(t,e,n){e.exports=class{constructor(t){this.recorder=t}inject(){try{document.addEventListener("click",t=>{const e={};e.target=JSON.stringify(t.target),e.posX=t.x,e.posY=t.y,e.isValid=t.isValid,this.recorder.recordInteraction(e)})}catch(t){console.error(t)}}}},{}]},{},[2])(2)});